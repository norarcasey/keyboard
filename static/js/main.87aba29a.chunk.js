(this.webpackJsonpkeyboard=this.webpackJsonpkeyboard||[]).push([[0],{127:function(e,t,a){},128:function(e,t,a){},170:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){"use strict";a.r(t);var n,r=a(0),c=a.n(r),o=a(68),i=a.n(o),l=(a(77),a(3)),u=a(52);function s(e,t){switch(t.type){case n.AddPlaybackNote:return[].concat(Object(u.a)(e),[t.payload]);case n.ClearPlaybackNotes:return[];default:return Object(u.a)(e)}}!function(e){e.AddPlaybackNote="AddPlaybackNote",e.ClearPlaybackNotes="ClearPlaybackNotes"}(n||(n={}));var m,y=a(2),d=a.n(y),b=Object(r.createContext)({}),k=(b.Consumer,function(e){var t=Object(r.useRef)(0),a=Object(r.useReducer)(s,[]),o=Object(l.a)(a,2),i=o[0],u=o[1],m=Object(r.useCallback)((function(e){var a=(new Date).getTime()/1e3;0===t.current&&(t.current=a),e.time=y(a).toBarsBeatsSixteenths(),u({type:n.AddPlaybackNote,payload:e})}),[t]);Object(r.useEffect)((function(){if(1===i.length){var e=(new Date).getTime()/1e3;t.current=e}}),[i]);var y=function(e){return d.a.Time(e-t.current)};return c.a.createElement(b.Provider,{value:{captureNote:m,calculateDuration:function(e){return d.a.Time(((new Date).getTime()-e)/1e3).toNotation()},calculateTime:function(e){return d.a.Time(e-t.current).toBarsBeatsSixteenths()},captureStartTime:t.current,clearCaptureData:function(){u({type:n.ClearPlaybackNotes,payload:[]})},playbackNotes:i}},e.children)});function f(e,t){switch(t.type){case m.OverwriteKeyPressData:var a=t.payload;return e[a.keyPressed]=a.keyData,e;default:return e}}!function(e){e.OverwriteKeyPressData="OverwriteKeyPressData"}(m||(m={}));var v=a(69),p=(a(79),function(e){var t=Object(r.useContext)(b),a=Object(r.useState)(),n=Object(l.a)(a,2),o=n[0],i=n[1],u=Object(r.useState)((new d.a.Synth).toMaster()),s=Object(l.a)(u,1)[0],m=e.color,y=e.keyboardKey,k=e.note,f=e.style,p=function(){s.triggerAttack(k);var e=(new Date).getTime();i(e)},E=function(){s.triggerRelease();var e=t.calculateDuration(o),a={note:k,dur:e};t.captureNote(a)};return v.isMobile?c.a.createElement("div",{className:"key ".concat(m),style:f,onTouchStart:p,onTouchEnd:E},c.a.createElement("div",{className:"note-name"},k,"(",y,")")):c.a.createElement("div",{className:"key ".concat(m),style:f,onMouseDown:p,onMouseUp:E},c.a.createElement("div",{className:"note-name"},k,"(",y,")"))}),E=(a(80),a(50)),O=a.n(E),T=Object(r.createContext)({}),N=function(e){var t=Object(r.useRef)(4);return c.a.createElement(T.Provider,{value:{formatKeyOctave:function(e,a){return"".concat(e).concat(t.current+Math.floor(a/12))},octave:t.current,setOctave:function(e){t.current=e}}},e.children)},g=function(e){var t=Object(r.useContext)(b),a=Object(r.useContext)(T),n=Object(r.useReducer)(f,{}),o=Object(l.a)(n,2),i=o[0],u=o[1],s=[{key:"C",keyboardKey:"a"},{key:"C#",keyboardKey:"w",color:"black",style:{left:"65px"}},{key:"D",keyboardKey:"s"},{key:"Eb",keyboardKey:"e",color:"black",style:{left:"200px"}},{key:"E",keyboardKey:"d"},{key:"F",keyboardKey:"f"},{key:"F#",keyboardKey:"t",color:"black",style:{left:"432px"}},{key:"G",keyboardKey:"g"},{key:"G#",keyboardKey:"y",color:"black",style:{left:"551px"}},{key:"A",keyboardKey:"h"},{key:"Bb",keyboardKey:"u",color:"black",style:{left:"674px"}},{key:"B",keyboardKey:"j"},{key:"C",keyboardKey:"k"},{key:"C#",keyboardKey:"i",color:"black",style:{left:"909px"}},{key:"D",keyboardKey:"l"},{key:"Eb",keyboardKey:"o",color:"black",style:{left:"1030px"}},{key:"E",keyboardKey:";"}];return Object(r.useEffect)((function(){var e=function(e){var t=s.find((function(t){return t.keyboardKey===e?t:null}));return t?a.formatKeyOctave(t.key,s.indexOf(t)):null},n=function(t){return function(t){var a=e(t);if(a&&!O()(i[t],"isPressed",!1)){var n=i[t]||{};n.isPressed=!0,n.synth=n.synth||(new d.a.Synth).toMaster(),n.startTime=(new Date).getTime(),n.synth.triggerAttack(a),u({type:m.OverwriteKeyPressData,payload:{keyPressed:t,keyData:n}})}}(t.key.toString())};document.addEventListener("keydown",n,!1);var r=function(a){return function(a){var n=e(a);if(n&&O()(i[a],"isPressed",!1)){var r=i[a];r.synth.triggerRelease(),r.isPressed=!1;var c={note:n,dur:t.calculateDuration(r.startTime)};t.captureNote(c)}}(a.key.toString())};return document.addEventListener("keyup",r,!1),function(){window.removeEventListener("keydown",n),window.removeEventListener("keyup",r)}}),[t,i,a,s]),c.a.createElement("div",{className:"keyboard"},s.map((function(e,t){return c.a.createElement(p,{key:"".concat(e.key).concat(t),octave:a.octave,note:a.formatKeyOctave(e.key,t),keyboardKey:e.keyboardKey,color:e.color,style:e.style})})))},h=a(31),j=a(32),w=[{time:d.a.Time("0:0:0"),note:"D3",dur:"4n"},{time:d.a.Time("0:1:0"),note:"F3",dur:"8n."},{time:d.a.Time("0:1:3"),note:"D3",dur:"8n"},{time:d.a.Time("0:2:1"),note:"D3",dur:"16n"},{time:d.a.Time("0:2:2"),note:"G3",dur:"8n"},{time:d.a.Time("0:3:0"),note:"D3",dur:"8n"},{time:d.a.Time("0:3:2"),note:"C3",dur:"8n"},{time:d.a.Time("1:0:0"),note:"D3",dur:"4n"},{time:d.a.Time("1:1:0"),note:"A3",dur:"8n."},{time:d.a.Time("1:1:3"),note:"D3",dur:"8n"},{time:d.a.Time("1:2:1"),note:"D3",dur:"16n"},{time:d.a.Time("1:2:2"),note:"Bb3",dur:"8n"},{time:d.a.Time("1:3:0"),note:"A3",dur:"8n"},{time:d.a.Time("1:3:2"),note:"F3",dur:"8n"},{time:d.a.Time("2:0:0"),note:"D3",dur:"8n"},{time:d.a.Time("2:0:2"),note:"A3",dur:"8n"},{time:d.a.Time("2:1:0"),note:"D4",dur:"8n"},{time:d.a.Time("2:1:2"),note:"D3",dur:"16n"},{time:d.a.Time("2:1:3"),note:"C3",dur:"8n"},{time:d.a.Time("2:2:1"),note:"C3",dur:"16n"},{time:d.a.Time("2:2:2"),note:"A2",dur:"8n"},{time:d.a.Time("2:3:0"),note:"E3",dur:"8n"},{time:d.a.Time("2:3:2"),note:"D3",dur:"0:2:2"}],D=(a(127),function(e){var t=Object(r.useContext)(b),a=Object(r.useState)(),n=Object(l.a)(a,2),o=n[0],i=n[1],u=Object(r.useState)(),s=Object(l.a)(u,2),m=s[0],y=s[1],k=Object(r.useState)(w),f=Object(l.a)(k,2),v=f[0],p=f[1],E=Object(r.useState)(),O=Object(l.a)(E,2),T=O[0],N=O[1],g=Object(r.useState)((new d.a.Synth).toMaster()),D=Object(l.a)(g,1)[0];Object(r.useEffect)((function(){var e=t.playbackNotes;e.length>0?(N(e[e.length-1]),p(t.playbackNotes)):(N(w[w.length-1]),p(w))}),[t.playbackNotes]),Object(r.useEffect)((function(){m&&m.length>0&&(m.start(0),d.a.Transport.scheduleOnce((function(e){m.removeAll(),d.a.Transport.toggle(),i(!1)}),d.a.Time(T.time).toSeconds()+d.a.Time(T.dur).toSeconds()),d.a.Transport.toggle(),i(!0))}),[m,T]);return c.a.createElement("div",{className:"controls"},c.a.createElement("div",null,o?c.a.createElement("div",{onClick:function(){m.removeAll(),d.a.Transport.toggle(),i(!1)},title:"stop"},c.a.createElement(h.a,{size:"lg",icon:j.c})):c.a.createElement("div",{onClick:function(){y(new d.a.Part((function(e,t){D.triggerAttackRelease(t.note,t.dur,e)}),v))},title:"play"},c.a.createElement(h.a,{size:"lg",icon:j.b}))),c.a.createElement("div",{className:"clear",title:"clear",onClick:function(){t.clearCaptureData(),m&&m.length>0&&m.removeAll()}},c.a.createElement(h.a,{size:"lg",icon:j.a})))}),K=(a(128),function(e){var t=Object(r.useContext)(b);return c.a.createElement("div",{className:"play-back-display"},c.a.createElement("div",{className:"header"},c.a.createElement("span",{className:"note-header"},"Note"),c.a.createElement("span",{className:"duration-header"},"Duration"),c.a.createElement("span",{className:"time-header"},"Time")),c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"scroll-container"},t.playbackNotes.map((function(e,t){return c.a.createElement("div",{key:"note-".concat(e.note,"-").concat(t),className:"data"},c.a.createElement("span",{className:"note-data"},e.note),c.a.createElement("span",{className:"duration-data"},e.dur),c.a.createElement("span",{className:"time-data"},e.time))})))))}),C=a(71),P=(a(169),a(170),function(e){var t=Object(r.useContext)(T),a=Object(r.useState)(4),n=Object(l.a)(a,2),o=n[0],i=n[1];return c.a.createElement("div",{className:"set-octave"},c.a.createElement("label",null,"Octave"),c.a.createElement(C.a,{defaultValue:4,min:1,max:6,value:o,onChange:function(e){Number(e)?(i(e),t.setOctave(e)):i(parseInt(e.toString(),10))},required:!0}))}),x=(a(171),function(){return c.a.createElement("div",{className:"App"},c.a.createElement(N,null,c.a.createElement(k,null,c.a.createElement(g,null),c.a.createElement("div",{className:"playback-container"},c.a.createElement(K,null),c.a.createElement(D,null),c.a.createElement(P,null)))))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},72:function(e,t,a){e.exports=a(172)},77:function(e,t,a){},79:function(e,t,a){},80:function(e,t,a){}},[[72,1,2]]]);
//# sourceMappingURL=main.87aba29a.chunk.js.map